<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ASTRO System Documentation</title>
    <style>
        :root {
            --primary-color: #0f172a;
            --secondary-color: #334155;
            --accent-color: #2563eb;
            --bg-color: #ffffff;
            --text-color: #1e293b;
            --border-color: #e2e8f0;
            --code-bg: #f1f5f9;
        }
        body {
            font-family: system-ui, -apple-system, "Segoe UI", Roboto, sans-serif;
            line-height: 1.6;
            color: var(--text-color);
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }
        h1, h2, h3 { color: var(--primary-color); border-bottom: 1px solid var(--border-color); padding-bottom: 10px; }
        h1 { margin-bottom: 40px; }
        
        /* Functional Table Styles */
        table { width: 100%; border-collapse: collapse; margin: 20px 0; }
        th, td { border: 1px solid var(--border-color); padding: 12px; text-align: left; vertical-align: top; }
        th { background-color: var(--code-bg); font-weight: 600; }
        
        /* Code Blocks */
        pre { background: var(--primary-color); color: #fff; padding: 15px; border-radius: 6px; overflow-x: auto; }
        code { font-family: "Menlo", "Monaco", monospace; font-size: 0.9em; }
        .inline-code { background: var(--code-bg); padding: 2px 6px; border-radius: 4px; color: var(--secondary-color); }

        /* Status Indicators */
        .badge { display: inline-block; padding: 4px 8px; border-radius: 4px; font-size: 0.8em; font-weight: bold; }
        .badge-prod { background: #dcfce7; color: #166534; }
        .badge-sec { background: #fee2e2; color: #991b1b; }
        
        /* Grid Layout for Agents */
        .agent-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 20px; }
        .agent-card { border: 1px solid var(--border-color); padding: 20px; border-radius: 8px; }
        .agent-card h3 { border-bottom: none; margin-top: 0; }
    </style>
</head>
<body>

    <header>
        <h1>ASTRO: Autonomous Agent Ecosystem</h1>
        <p><strong>Technical Reference Manual v1.0.0</strong></p>
        <p>A Python-based multi-agent orchestration system utilizing asynchronous processing, local LLM inference, and containerized execution environments.</p>
    </header>

    <main>
        <section id="architecture">
            <h2>1. System Architecture</h2>
            <p>ASTRO utilizes a Hub-and-Spoke architecture managed by a central <code>AgentEngine</code>. The system operates asynchronously using Python's <code>asyncio</code> event loop.</p>
            
            <table>
                <thead>
                    <tr>
                        <th>Component</th>
                        <th>File Reference</th>
                        <th>Functionality</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Agent Engine</strong></td>
                        <td><code>src/core/engine.py</code></td>
                        <td>Central scheduler, task routing, priority queue management, and performance monitoring.</td>
                    </tr>
                    <tr>
                        <td><strong>NL Interface</strong></td>
                        <td><code>src/core/nl_interface.py</code></td>
                        <td>Intent classification and task decomposition. Sanitizes user input before LLM processing.</td>
                    </tr>
                    <tr>
                        <td><strong>Database</strong></td>
                        <td><code>src/core/database.py</code></td>
                        <td>SQLite implementation with WAL mode. Persists agents, workflows, tasks, and metrics.</td>
                    </tr>
                    <tr>
                        <td><strong>Event Bus</strong></td>
                        <td><code>src/core/a2a_protocol.py</code></td>
                        <td>Asynchronous message bus implementing the Actor Model for inter-agent communication.</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section id="agents">
            <h2>2. Agent Capabilities</h2>
            <div class="agent-grid">
                <div class="agent-card">
                    <h3>Research Agent</h3>
                    <p><strong>Class:</strong> <code>ResearchAgent</code></p>
                    <p><strong>Capabilities:</strong> Web Search, Content Extraction</p>
                    <p><strong>Backend:</strong> Uses <code>duckduckgo_search</code> for discovery and <code>aiohttp</code>/<code>BeautifulSoup</code> for content scraping. Implements async rate limiting.</p>
                </div>
                <div class="agent-card">
                    <h3>Code Agent</h3>
                    <p><strong>Class:</strong> <code>CodeAgent</code></p>
                    <p><strong>Capabilities:</strong> Code Generation, Execution</p>
                    <p><strong>Security:</strong> Enforces Docker sandboxing for execution. Uses AST analysis for static code verification.</p>
                </div>
                <div class="agent-card">
                    <h3>FileSystem Agent</h3>
                    <p><strong>Class:</strong> <code>FileSystemAgent</code></p>
                    <p><strong>Capabilities:</strong> I/O Operations</p>
                    <p><strong>Constraints:</strong> Operations restricted to <code>./workspace</code> root via <code>os.path.commonpath</code> validation.</p>
                </div>
            </div>
        </section>

        <section id="security">
            <h2>3. Security Model</h2>
            <p>The system implements defense-in-depth strategies for code execution and input handling.</p>
            
            <table>
                <thead>
                    <tr>
                        <th>Layer</th>
                        <th>Mechanism</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Code Sandbox</strong></td>
                        <td>Docker Container (Isolated Network)</td>
                        <td><span class="badge badge-prod">MANDATORY</span></td>
                    </tr>
                    <tr>
                        <td><strong>Input Sanitization</strong></td>
                        <td>Regex + AST Validation</td>
                        <td><span class="badge badge-prod">ACTIVE</span></td>
                    </tr>
                    <tr>
                        <td><strong>Path Traversal</strong></td>
                        <td>Commonpath Check</td>
                        <td><span class="badge badge-prod">ENFORCED</span></td>
                    </tr>
                    <tr>
                        <td><strong>Dependencies</strong></td>
                        <td>Pinned Versions (requirements.txt)</td>
                        <td><span class="badge badge-prod">AUDITED</span></td>
                    </tr>
                </tbody>
            </table>
            
            <div class="warning" style="margin-top: 20px; padding: 15px; background: #fff5f5; border: 1px solid #fee2e2; border-radius: 6px;">
                <strong>Security Warning:</strong> Local execution fallback (`allow_local_execution`) bypasses Docker isolation and should be disabled in production environments per ADR-002.
            </div>
        </section>

        <section id="advanced-systems">
            <h2>4. Advanced Subsystems</h2>
            <p>Technical nomenclature for internal system modules (mapped from project-specific naming conventions).</p>
            
            <table>
                <thead>
                    <tr>
                        <th>Module Name</th>
                        <th>System Function</th>
                        <th>Description</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>recursive_learning.py</code></td>
                        <td><strong>Contextual Memory (RAG)</strong></td>
                        <td>Stores successful task inputs/outputs in SQLite/ChromaDB for retrieval based on context similarity.</td>
                    </tr>
                    <tr>
                        <td><code>adaptive_jit.py</code></td>
                        <td><strong>Smart Memoization</strong></td>
                        <td>Profiles function calls and applies LRU/TTL caching strategies to hot paths.</td>
                    </tr>
                    <tr>
                        <td><code>zero_reasoning.py</code></td>
                        <td><strong>Structured Prompting</strong></td>
                        <td>Orchestrates Chain-of-Thought (CoT) and Tree-of-Thought (ToT) prompts to improve LLM output reliability.</td>
                    </tr>
                    <tr>
                        <td><code>self_healing.py</code></td>
                        <td><strong>Fault Tolerance</strong></td>
                        <td>Implements Circuit Breaker patterns and exponential backoff retry policies.</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section id="usage">
            <h2>5. Interface & Execution</h2>
            
            <h3>Headless Mode (CLI)</h3>
            <pre><code>python src/main.py --interactive --llm-provider ollama --model-name llama3.2</code></pre>
            
            <h3>Graphical Interface</h3>
            <p><strong>Entry Point:</strong> <code>src/gui_app.py</code></p>
            <p>The GUI provides a visual wrapper for the <code>AgentEngine</code>, offering real-time log streaming, workflow history visualization, and agent status indicators. It utilizes <code>customtkinter</code> for rendering.</p>
        </section>

    </main>

    <footer style="margin-top: 60px; padding-top: 20px; border-top: 1px solid var(--border-color); font-size: 0.9em; color: var(--secondary-color);">
        <p>Generated by C0Di3 | Based on Codebase Revision: <code>81bc118</code></p>
    </footer>

</body>
</html>
